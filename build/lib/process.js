"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.getProcessIds = getProcessIds;
exports.killProcess = killProcess;
require("source-map-support/register");
var _aitProcess = require("ait-process");
async function getProcessIds(appName) {
  let pids;
  try {
    let {
      stdout
    } = await (0, _aitProcess.exec)('pgrep', ['-x', appName]);
    pids = stdout.trim().split('\n').map(pid => parseInt(pid, 10));
  } catch (err) {
    if (parseInt(err.code, 10) !== 1) {
      throw new Error(`Error getting process ids for app '${appName}': ${err.message}`);
    }
    pids = [];
  }
  return pids;
}
async function killProcess(appName, force = false) {
  let pids = await getProcessIds(appName);
  if (pids.length === 0) {
    return;
  }
  try {
    let args = force ? ['-9'] : [];
    args.push('-x', appName);
    await (0, _aitProcess.exec)('pkill', args);
  } catch (err) {
    if (parseInt(err.code, 10) !== 1) {
      throw new Error(`Error killing app '${appName}' with pkill: ${err.message}`);
    }
  }
}require('source-map-support').install();


//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibGliL3Byb2Nlc3MuanMiLCJuYW1lcyI6WyJfYWl0UHJvY2VzcyIsInJlcXVpcmUiLCJnZXRQcm9jZXNzSWRzIiwiYXBwTmFtZSIsInBpZHMiLCJzdGRvdXQiLCJleGVjIiwidHJpbSIsInNwbGl0IiwibWFwIiwicGlkIiwicGFyc2VJbnQiLCJlcnIiLCJjb2RlIiwiRXJyb3IiLCJtZXNzYWdlIiwia2lsbFByb2Nlc3MiLCJmb3JjZSIsImxlbmd0aCIsImFyZ3MiLCJwdXNoIl0sInNvdXJjZVJvb3QiOiIuLi8uLiIsInNvdXJjZXMiOlsibGliL3Byb2Nlc3MuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtleGVjfSBmcm9tICdhaXQtcHJvY2Vzcyc7XG5cbi8qXG4gKiBFeGl0IFN0YXR1cyBmb3IgcGdyZXAgYW5kIHBraWxsIChgbWFuIHBraWxsYClcbiAqICAwLiBPbmUgb3IgbW9yZSBwcm9jZXNzZXMgbWF0Y2hlZCB0aGUgY3JpdGVyaWEuXG4gKiAgMS4gTm8gcHJvY2Vzc2VzIG1hdGNoZWQuXG4gKiAgMi4gU3ludGF4IGVycm9yIGluIHRoZSBjb21tYW5kIGxpbmUuXG4gKiAgMy4gRmF0YWwgZXJyb3I6IG91dCBvZiBtZW1vcnkgZXRjLlxuICovXG5cbmFzeW5jIGZ1bmN0aW9uIGdldFByb2Nlc3NJZHMgKGFwcE5hbWUpIHtcbiAgbGV0IHBpZHM7XG4gIHRyeSB7XG4gICAgbGV0IHtzdGRvdXR9ID0gYXdhaXQgZXhlYygncGdyZXAnLCBbJy14JywgYXBwTmFtZV0pO1xuICAgIHBpZHMgPSBzdGRvdXRcbiAgICAgIC50cmltKClcbiAgICAgIC5zcGxpdCgnXFxuJylcbiAgICAgIC5tYXAoKHBpZCkgPT4gcGFyc2VJbnQocGlkLCAxMCkpO1xuICB9IGNhdGNoIChlcnIpIHtcbiAgICBpZiAocGFyc2VJbnQoZXJyLmNvZGUsIDEwKSAhPT0gMSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBFcnJvciBnZXR0aW5nIHByb2Nlc3MgaWRzIGZvciBhcHAgJyR7YXBwTmFtZX0nOiAke2Vyci5tZXNzYWdlfWApO1xuICAgIH1cbiAgICBwaWRzID0gW107XG4gIH1cbiAgcmV0dXJuIHBpZHM7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGtpbGxQcm9jZXNzIChhcHBOYW1lLCBmb3JjZSA9IGZhbHNlKSB7XG4gIGxldCBwaWRzID0gYXdhaXQgZ2V0UHJvY2Vzc0lkcyhhcHBOYW1lKTtcbiAgaWYgKHBpZHMubGVuZ3RoID09PSAwKSB7XG4gICAgLy8gdGhlIHByb2Nlc3MgaXMgbm90IHJ1bm5pbmdcbiAgICByZXR1cm47XG4gIH1cblxuICB0cnkge1xuICAgIGxldCBhcmdzID0gZm9yY2UgPyBbJy05J10gOiBbXTtcbiAgICBhcmdzLnB1c2goJy14JywgYXBwTmFtZSk7XG4gICAgYXdhaXQgZXhlYygncGtpbGwnLCBhcmdzKTtcbiAgfSBjYXRjaCAoZXJyKSB7XG4gICAgaWYgKHBhcnNlSW50KGVyci5jb2RlLCAxMCkgIT09IDEpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgRXJyb3Iga2lsbGluZyBhcHAgJyR7YXBwTmFtZX0nIHdpdGggcGtpbGw6ICR7ZXJyLm1lc3NhZ2V9YCk7XG4gICAgfVxuICB9XG59XG5cbmV4cG9ydCB7Z2V0UHJvY2Vzc0lkcywga2lsbFByb2Nlc3N9O1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUFBLElBQUFBLFdBQUEsR0FBQUMsT0FBQTtBQVVBLGVBQWVDLGFBQWFBLENBQUVDLE9BQU8sRUFBRTtFQUNyQyxJQUFJQyxJQUFJO0VBQ1IsSUFBSTtJQUNGLElBQUk7TUFBQ0M7SUFBTSxDQUFDLEdBQUcsTUFBTSxJQUFBQyxnQkFBSSxFQUFDLE9BQU8sRUFBRSxDQUFDLElBQUksRUFBRUgsT0FBTyxDQUFDLENBQUM7SUFDbkRDLElBQUksR0FBR0MsTUFBTSxDQUNWRSxJQUFJLENBQUMsQ0FBQyxDQUNOQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQ1hDLEdBQUcsQ0FBRUMsR0FBRyxJQUFLQyxRQUFRLENBQUNELEdBQUcsRUFBRSxFQUFFLENBQUMsQ0FBQztFQUNwQyxDQUFDLENBQUMsT0FBT0UsR0FBRyxFQUFFO0lBQ1osSUFBSUQsUUFBUSxDQUFDQyxHQUFHLENBQUNDLElBQUksRUFBRSxFQUFFLENBQUMsS0FBSyxDQUFDLEVBQUU7TUFDaEMsTUFBTSxJQUFJQyxLQUFLLENBQUUsc0NBQXFDWCxPQUFRLE1BQUtTLEdBQUcsQ0FBQ0csT0FBUSxFQUFDLENBQUM7SUFDbkY7SUFDQVgsSUFBSSxHQUFHLEVBQUU7RUFDWDtFQUNBLE9BQU9BLElBQUk7QUFDYjtBQUVBLGVBQWVZLFdBQVdBLENBQUViLE9BQU8sRUFBRWMsS0FBSyxHQUFHLEtBQUssRUFBRTtFQUNsRCxJQUFJYixJQUFJLEdBQUcsTUFBTUYsYUFBYSxDQUFDQyxPQUFPLENBQUM7RUFDdkMsSUFBSUMsSUFBSSxDQUFDYyxNQUFNLEtBQUssQ0FBQyxFQUFFO0lBRXJCO0VBQ0Y7RUFFQSxJQUFJO0lBQ0YsSUFBSUMsSUFBSSxHQUFHRixLQUFLLEdBQUcsQ0FBQyxJQUFJLENBQUMsR0FBRyxFQUFFO0lBQzlCRSxJQUFJLENBQUNDLElBQUksQ0FBQyxJQUFJLEVBQUVqQixPQUFPLENBQUM7SUFDeEIsTUFBTSxJQUFBRyxnQkFBSSxFQUFDLE9BQU8sRUFBRWEsSUFBSSxDQUFDO0VBQzNCLENBQUMsQ0FBQyxPQUFPUCxHQUFHLEVBQUU7SUFDWixJQUFJRCxRQUFRLENBQUNDLEdBQUcsQ0FBQ0MsSUFBSSxFQUFFLEVBQUUsQ0FBQyxLQUFLLENBQUMsRUFBRTtNQUNoQyxNQUFNLElBQUlDLEtBQUssQ0FBRSxzQkFBcUJYLE9BQVEsaUJBQWdCUyxHQUFHLENBQUNHLE9BQVEsRUFBQyxDQUFDO0lBQzlFO0VBQ0Y7QUFDRiJ9
