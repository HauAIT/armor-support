"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
require("source-map-support/register");
var _index = require("../index.js");
var _chai = _interopRequireDefault(require("chai"));
_chai.default.should();
describe('tempdir', function () {
  afterEach(function () {
    delete process.env.ARMOR_TMP_DIR;
  });
  it('should be able to generate a path', async function () {
    const path = await _index.tempDir.path({
      prefix: 'myfile',
      suffix: '.tmp'
    });
    path.should.exist;
    path.should.include('myfile.tmp');
  });
  it('should be able to generate a path with process.env.ARMOR_TMP_DIR', async function () {
    const preRootDirPath = await _index.tempDir.openDir();
    process.env.ARMOR_TMP_DIR = preRootDirPath;
    const path = await _index.tempDir.path({
      prefix: 'myfile',
      suffix: '.tmp'
    });
    path.should.exist;
    path.should.include(preRootDirPath);
    path.should.include('myfile.tmp');
  });
  it('should be able to create a temp file', async function () {
    let res = await _index.tempDir.open({
      prefix: 'my-test-file',
      suffix: '.zip'
    });
    res.should.exist;
    res.path.should.exist;
    res.path.should.include('my-test-file.zip');
    res.fd.should.exist;
    await _index.fs.exists(res.path).should.eventually.be.ok;
  });
  it('should be able to create a temp file with process.env.ARMOR_TMP_DIR', async function () {
    const preRootDirPath = await _index.tempDir.openDir();
    process.env.ARMOR_TMP_DIR = preRootDirPath;
    let res = await _index.tempDir.open({
      prefix: 'my-test-file',
      suffix: '.zip'
    });
    res.should.exist;
    res.path.should.exist;
    res.path.should.include(preRootDirPath);
    res.path.should.include('my-test-file.zip');
    res.fd.should.exist;
    await _index.fs.exists(res.path).should.eventually.be.ok;
  });
  it('should generate a random temp dir', async function () {
    let res = await _index.tempDir.openDir();
    res.should.be.a('string');
    await _index.fs.exists(res).should.eventually.be.ok;
    let res2 = await _index.tempDir.openDir();
    await _index.fs.exists(res2).should.eventually.be.ok;
    res.should.not.equal(res2);
  });
  it('should generate a random temp dir, but the same with process.env.ARMOR_TMP_DIR', async function () {
    const preRootDirPath = await _index.tempDir.openDir();
    process.env.ARMOR_TMP_DIR = preRootDirPath;
    const res = await _index.tempDir.openDir();
    res.should.be.a('string');
    await _index.fs.exists(res).should.eventually.be.ok;
    const res2 = await _index.tempDir.openDir();
    await _index.fs.exists(res2).should.eventually.be.ok;
    res.should.include(preRootDirPath);
    res2.should.include(preRootDirPath);
    res.should.not.equal(res2);
  });
  it('should generate one temp dir used for the life of the process', async function () {
    let res = await _index.tempDir.staticDir();
    res.should.be.a('string');
    await _index.fs.exists(res).should.eventually.be.ok;
    let res2 = await _index.tempDir.staticDir();
    await _index.fs.exists(res2).should.eventually.be.ok;
    res.should.equal(res2);
  });
});require('source-map-support').install();


//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGVzdC90ZW1wZGlyLXNwZWNzLmpzIiwibmFtZXMiOlsiX2luZGV4IiwicmVxdWlyZSIsIl9jaGFpIiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsImNoYWkiLCJzaG91bGQiLCJkZXNjcmliZSIsImFmdGVyRWFjaCIsInByb2Nlc3MiLCJlbnYiLCJBUk1PUl9UTVBfRElSIiwiaXQiLCJwYXRoIiwidGVtcERpciIsInByZWZpeCIsInN1ZmZpeCIsImV4aXN0IiwiaW5jbHVkZSIsInByZVJvb3REaXJQYXRoIiwib3BlbkRpciIsInJlcyIsIm9wZW4iLCJmZCIsImZzIiwiZXhpc3RzIiwiZXZlbnR1YWxseSIsImJlIiwib2siLCJhIiwicmVzMiIsIm5vdCIsImVxdWFsIiwic3RhdGljRGlyIl0sInNvdXJjZVJvb3QiOiIuLi8uLiIsInNvdXJjZXMiOlsidGVzdC90ZW1wZGlyLXNwZWNzLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIlxuaW1wb3J0IHsgdGVtcERpciwgZnMgfSBmcm9tICcuLi9pbmRleC5qcyc7XG5pbXBvcnQgY2hhaSBmcm9tICdjaGFpJztcblxuY2hhaS5zaG91bGQoKTtcblxuZGVzY3JpYmUoJ3RlbXBkaXInLCBmdW5jdGlvbiAoKSB7XG4gIGFmdGVyRWFjaChmdW5jdGlvbiAoKSB7XG4gICAgLy8gc2V0IHRoZSBwcm9jZXNzIGVudiBhcyB1bmRlZmllbmRcbiAgICBkZWxldGUgcHJvY2Vzcy5lbnYuQVJNT1JfVE1QX0RJUjtcbiAgfSk7XG5cbiAgaXQoJ3Nob3VsZCBiZSBhYmxlIHRvIGdlbmVyYXRlIGEgcGF0aCcsIGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCBwYXRoID0gYXdhaXQgdGVtcERpci5wYXRoKHtwcmVmaXg6ICdteWZpbGUnLCBzdWZmaXg6ICcudG1wJ30pO1xuICAgIHBhdGguc2hvdWxkLmV4aXN0O1xuICAgIHBhdGguc2hvdWxkLmluY2x1ZGUoJ215ZmlsZS50bXAnKTtcbiAgfSk7XG5cbiAgaXQoJ3Nob3VsZCBiZSBhYmxlIHRvIGdlbmVyYXRlIGEgcGF0aCB3aXRoIHByb2Nlc3MuZW52LkFSTU9SX1RNUF9ESVInLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgY29uc3QgcHJlUm9vdERpclBhdGggPSBhd2FpdCB0ZW1wRGlyLm9wZW5EaXIoKTtcbiAgICBwcm9jZXNzLmVudi5BUk1PUl9UTVBfRElSID0gcHJlUm9vdERpclBhdGg7XG5cbiAgICBjb25zdCBwYXRoID0gYXdhaXQgdGVtcERpci5wYXRoKHtwcmVmaXg6ICdteWZpbGUnLCBzdWZmaXg6ICcudG1wJ30pO1xuICAgIHBhdGguc2hvdWxkLmV4aXN0O1xuICAgIHBhdGguc2hvdWxkLmluY2x1ZGUocHJlUm9vdERpclBhdGgpO1xuICAgIHBhdGguc2hvdWxkLmluY2x1ZGUoJ215ZmlsZS50bXAnKTtcbiAgfSk7XG5cbiAgaXQoJ3Nob3VsZCBiZSBhYmxlIHRvIGNyZWF0ZSBhIHRlbXAgZmlsZScsIGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICBsZXQgcmVzID0gYXdhaXQgdGVtcERpci5vcGVuKHtwcmVmaXg6ICdteS10ZXN0LWZpbGUnLCBzdWZmaXg6ICcuemlwJ30pO1xuICAgIHJlcy5zaG91bGQuZXhpc3Q7XG4gICAgcmVzLnBhdGguc2hvdWxkLmV4aXN0O1xuICAgIHJlcy5wYXRoLnNob3VsZC5pbmNsdWRlKCdteS10ZXN0LWZpbGUuemlwJyk7XG4gICAgcmVzLmZkLnNob3VsZC5leGlzdDtcbiAgICBhd2FpdCBmcy5leGlzdHMocmVzLnBhdGgpLnNob3VsZC5ldmVudHVhbGx5LmJlLm9rO1xuICB9KTtcblxuICBpdCgnc2hvdWxkIGJlIGFibGUgdG8gY3JlYXRlIGEgdGVtcCBmaWxlIHdpdGggcHJvY2Vzcy5lbnYuQVJNT1JfVE1QX0RJUicsIGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCBwcmVSb290RGlyUGF0aCA9IGF3YWl0IHRlbXBEaXIub3BlbkRpcigpO1xuICAgIHByb2Nlc3MuZW52LkFSTU9SX1RNUF9ESVIgPSBwcmVSb290RGlyUGF0aDtcblxuICAgIGxldCByZXMgPSBhd2FpdCB0ZW1wRGlyLm9wZW4oe3ByZWZpeDogJ215LXRlc3QtZmlsZScsIHN1ZmZpeDogJy56aXAnfSk7XG4gICAgcmVzLnNob3VsZC5leGlzdDtcbiAgICByZXMucGF0aC5zaG91bGQuZXhpc3Q7XG4gICAgcmVzLnBhdGguc2hvdWxkLmluY2x1ZGUocHJlUm9vdERpclBhdGgpO1xuICAgIHJlcy5wYXRoLnNob3VsZC5pbmNsdWRlKCdteS10ZXN0LWZpbGUuemlwJyk7XG4gICAgcmVzLmZkLnNob3VsZC5leGlzdDtcbiAgICBhd2FpdCBmcy5leGlzdHMocmVzLnBhdGgpLnNob3VsZC5ldmVudHVhbGx5LmJlLm9rO1xuICB9KTtcblxuICBpdCgnc2hvdWxkIGdlbmVyYXRlIGEgcmFuZG9tIHRlbXAgZGlyJywgYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgIGxldCByZXMgPSBhd2FpdCB0ZW1wRGlyLm9wZW5EaXIoKTtcbiAgICByZXMuc2hvdWxkLmJlLmEoJ3N0cmluZycpO1xuICAgIGF3YWl0IGZzLmV4aXN0cyhyZXMpLnNob3VsZC5ldmVudHVhbGx5LmJlLm9rO1xuICAgIGxldCByZXMyID0gYXdhaXQgdGVtcERpci5vcGVuRGlyKCk7XG4gICAgYXdhaXQgZnMuZXhpc3RzKHJlczIpLnNob3VsZC5ldmVudHVhbGx5LmJlLm9rO1xuICAgIHJlcy5zaG91bGQubm90LmVxdWFsKHJlczIpO1xuICB9KTtcblxuICBpdCgnc2hvdWxkIGdlbmVyYXRlIGEgcmFuZG9tIHRlbXAgZGlyLCBidXQgdGhlIHNhbWUgd2l0aCBwcm9jZXNzLmVudi5BUk1PUl9UTVBfRElSJywgYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0IHByZVJvb3REaXJQYXRoID0gYXdhaXQgdGVtcERpci5vcGVuRGlyKCk7XG4gICAgcHJvY2Vzcy5lbnYuQVJNT1JfVE1QX0RJUiA9IHByZVJvb3REaXJQYXRoO1xuXG4gICAgY29uc3QgcmVzID0gYXdhaXQgdGVtcERpci5vcGVuRGlyKCk7XG4gICAgcmVzLnNob3VsZC5iZS5hKCdzdHJpbmcnKTtcbiAgICBhd2FpdCBmcy5leGlzdHMocmVzKS5zaG91bGQuZXZlbnR1YWxseS5iZS5vaztcbiAgICBjb25zdCByZXMyID0gYXdhaXQgdGVtcERpci5vcGVuRGlyKCk7XG4gICAgYXdhaXQgZnMuZXhpc3RzKHJlczIpLnNob3VsZC5ldmVudHVhbGx5LmJlLm9rO1xuICAgIHJlcy5zaG91bGQuaW5jbHVkZShwcmVSb290RGlyUGF0aCk7XG4gICAgcmVzMi5zaG91bGQuaW5jbHVkZShwcmVSb290RGlyUGF0aCk7XG4gICAgcmVzLnNob3VsZC5ub3QuZXF1YWwocmVzMik7XG4gIH0pO1xuXG4gIGl0KCdzaG91bGQgZ2VuZXJhdGUgb25lIHRlbXAgZGlyIHVzZWQgZm9yIHRoZSBsaWZlIG9mIHRoZSBwcm9jZXNzJywgYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgIGxldCByZXMgPSBhd2FpdCB0ZW1wRGlyLnN0YXRpY0RpcigpO1xuICAgIHJlcy5zaG91bGQuYmUuYSgnc3RyaW5nJyk7XG4gICAgYXdhaXQgZnMuZXhpc3RzKHJlcykuc2hvdWxkLmV2ZW50dWFsbHkuYmUub2s7XG4gICAgbGV0IHJlczIgPSBhd2FpdCB0ZW1wRGlyLnN0YXRpY0RpcigpO1xuICAgIGF3YWl0IGZzLmV4aXN0cyhyZXMyKS5zaG91bGQuZXZlbnR1YWxseS5iZS5vaztcbiAgICByZXMuc2hvdWxkLmVxdWFsKHJlczIpO1xuICB9KTtcbn0pO1xuIl0sIm1hcHBpbmdzIjoiOzs7O0FBQ0EsSUFBQUEsTUFBQSxHQUFBQyxPQUFBO0FBQ0EsSUFBQUMsS0FBQSxHQUFBQyxzQkFBQSxDQUFBRixPQUFBO0FBRUFHLGFBQUksQ0FBQ0MsTUFBTSxDQUFDLENBQUM7QUFFYkMsUUFBUSxDQUFDLFNBQVMsRUFBRSxZQUFZO0VBQzlCQyxTQUFTLENBQUMsWUFBWTtJQUVwQixPQUFPQyxPQUFPLENBQUNDLEdBQUcsQ0FBQ0MsYUFBYTtFQUNsQyxDQUFDLENBQUM7RUFFRkMsRUFBRSxDQUFDLG1DQUFtQyxFQUFFLGtCQUFrQjtJQUN4RCxNQUFNQyxJQUFJLEdBQUcsTUFBTUMsY0FBTyxDQUFDRCxJQUFJLENBQUM7TUFBQ0UsTUFBTSxFQUFFLFFBQVE7TUFBRUMsTUFBTSxFQUFFO0lBQU0sQ0FBQyxDQUFDO0lBQ25FSCxJQUFJLENBQUNQLE1BQU0sQ0FBQ1csS0FBSztJQUNqQkosSUFBSSxDQUFDUCxNQUFNLENBQUNZLE9BQU8sQ0FBQyxZQUFZLENBQUM7RUFDbkMsQ0FBQyxDQUFDO0VBRUZOLEVBQUUsQ0FBQyxrRUFBa0UsRUFBRSxrQkFBa0I7SUFDdkYsTUFBTU8sY0FBYyxHQUFHLE1BQU1MLGNBQU8sQ0FBQ00sT0FBTyxDQUFDLENBQUM7SUFDOUNYLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDQyxhQUFhLEdBQUdRLGNBQWM7SUFFMUMsTUFBTU4sSUFBSSxHQUFHLE1BQU1DLGNBQU8sQ0FBQ0QsSUFBSSxDQUFDO01BQUNFLE1BQU0sRUFBRSxRQUFRO01BQUVDLE1BQU0sRUFBRTtJQUFNLENBQUMsQ0FBQztJQUNuRUgsSUFBSSxDQUFDUCxNQUFNLENBQUNXLEtBQUs7SUFDakJKLElBQUksQ0FBQ1AsTUFBTSxDQUFDWSxPQUFPLENBQUNDLGNBQWMsQ0FBQztJQUNuQ04sSUFBSSxDQUFDUCxNQUFNLENBQUNZLE9BQU8sQ0FBQyxZQUFZLENBQUM7RUFDbkMsQ0FBQyxDQUFDO0VBRUZOLEVBQUUsQ0FBQyxzQ0FBc0MsRUFBRSxrQkFBa0I7SUFDM0QsSUFBSVMsR0FBRyxHQUFHLE1BQU1QLGNBQU8sQ0FBQ1EsSUFBSSxDQUFDO01BQUNQLE1BQU0sRUFBRSxjQUFjO01BQUVDLE1BQU0sRUFBRTtJQUFNLENBQUMsQ0FBQztJQUN0RUssR0FBRyxDQUFDZixNQUFNLENBQUNXLEtBQUs7SUFDaEJJLEdBQUcsQ0FBQ1IsSUFBSSxDQUFDUCxNQUFNLENBQUNXLEtBQUs7SUFDckJJLEdBQUcsQ0FBQ1IsSUFBSSxDQUFDUCxNQUFNLENBQUNZLE9BQU8sQ0FBQyxrQkFBa0IsQ0FBQztJQUMzQ0csR0FBRyxDQUFDRSxFQUFFLENBQUNqQixNQUFNLENBQUNXLEtBQUs7SUFDbkIsTUFBTU8sU0FBRSxDQUFDQyxNQUFNLENBQUNKLEdBQUcsQ0FBQ1IsSUFBSSxDQUFDLENBQUNQLE1BQU0sQ0FBQ29CLFVBQVUsQ0FBQ0MsRUFBRSxDQUFDQyxFQUFFO0VBQ25ELENBQUMsQ0FBQztFQUVGaEIsRUFBRSxDQUFDLHFFQUFxRSxFQUFFLGtCQUFrQjtJQUMxRixNQUFNTyxjQUFjLEdBQUcsTUFBTUwsY0FBTyxDQUFDTSxPQUFPLENBQUMsQ0FBQztJQUM5Q1gsT0FBTyxDQUFDQyxHQUFHLENBQUNDLGFBQWEsR0FBR1EsY0FBYztJQUUxQyxJQUFJRSxHQUFHLEdBQUcsTUFBTVAsY0FBTyxDQUFDUSxJQUFJLENBQUM7TUFBQ1AsTUFBTSxFQUFFLGNBQWM7TUFBRUMsTUFBTSxFQUFFO0lBQU0sQ0FBQyxDQUFDO0lBQ3RFSyxHQUFHLENBQUNmLE1BQU0sQ0FBQ1csS0FBSztJQUNoQkksR0FBRyxDQUFDUixJQUFJLENBQUNQLE1BQU0sQ0FBQ1csS0FBSztJQUNyQkksR0FBRyxDQUFDUixJQUFJLENBQUNQLE1BQU0sQ0FBQ1ksT0FBTyxDQUFDQyxjQUFjLENBQUM7SUFDdkNFLEdBQUcsQ0FBQ1IsSUFBSSxDQUFDUCxNQUFNLENBQUNZLE9BQU8sQ0FBQyxrQkFBa0IsQ0FBQztJQUMzQ0csR0FBRyxDQUFDRSxFQUFFLENBQUNqQixNQUFNLENBQUNXLEtBQUs7SUFDbkIsTUFBTU8sU0FBRSxDQUFDQyxNQUFNLENBQUNKLEdBQUcsQ0FBQ1IsSUFBSSxDQUFDLENBQUNQLE1BQU0sQ0FBQ29CLFVBQVUsQ0FBQ0MsRUFBRSxDQUFDQyxFQUFFO0VBQ25ELENBQUMsQ0FBQztFQUVGaEIsRUFBRSxDQUFDLG1DQUFtQyxFQUFFLGtCQUFrQjtJQUN4RCxJQUFJUyxHQUFHLEdBQUcsTUFBTVAsY0FBTyxDQUFDTSxPQUFPLENBQUMsQ0FBQztJQUNqQ0MsR0FBRyxDQUFDZixNQUFNLENBQUNxQixFQUFFLENBQUNFLENBQUMsQ0FBQyxRQUFRLENBQUM7SUFDekIsTUFBTUwsU0FBRSxDQUFDQyxNQUFNLENBQUNKLEdBQUcsQ0FBQyxDQUFDZixNQUFNLENBQUNvQixVQUFVLENBQUNDLEVBQUUsQ0FBQ0MsRUFBRTtJQUM1QyxJQUFJRSxJQUFJLEdBQUcsTUFBTWhCLGNBQU8sQ0FBQ00sT0FBTyxDQUFDLENBQUM7SUFDbEMsTUFBTUksU0FBRSxDQUFDQyxNQUFNLENBQUNLLElBQUksQ0FBQyxDQUFDeEIsTUFBTSxDQUFDb0IsVUFBVSxDQUFDQyxFQUFFLENBQUNDLEVBQUU7SUFDN0NQLEdBQUcsQ0FBQ2YsTUFBTSxDQUFDeUIsR0FBRyxDQUFDQyxLQUFLLENBQUNGLElBQUksQ0FBQztFQUM1QixDQUFDLENBQUM7RUFFRmxCLEVBQUUsQ0FBQyxnRkFBZ0YsRUFBRSxrQkFBa0I7SUFDckcsTUFBTU8sY0FBYyxHQUFHLE1BQU1MLGNBQU8sQ0FBQ00sT0FBTyxDQUFDLENBQUM7SUFDOUNYLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDQyxhQUFhLEdBQUdRLGNBQWM7SUFFMUMsTUFBTUUsR0FBRyxHQUFHLE1BQU1QLGNBQU8sQ0FBQ00sT0FBTyxDQUFDLENBQUM7SUFDbkNDLEdBQUcsQ0FBQ2YsTUFBTSxDQUFDcUIsRUFBRSxDQUFDRSxDQUFDLENBQUMsUUFBUSxDQUFDO0lBQ3pCLE1BQU1MLFNBQUUsQ0FBQ0MsTUFBTSxDQUFDSixHQUFHLENBQUMsQ0FBQ2YsTUFBTSxDQUFDb0IsVUFBVSxDQUFDQyxFQUFFLENBQUNDLEVBQUU7SUFDNUMsTUFBTUUsSUFBSSxHQUFHLE1BQU1oQixjQUFPLENBQUNNLE9BQU8sQ0FBQyxDQUFDO0lBQ3BDLE1BQU1JLFNBQUUsQ0FBQ0MsTUFBTSxDQUFDSyxJQUFJLENBQUMsQ0FBQ3hCLE1BQU0sQ0FBQ29CLFVBQVUsQ0FBQ0MsRUFBRSxDQUFDQyxFQUFFO0lBQzdDUCxHQUFHLENBQUNmLE1BQU0sQ0FBQ1ksT0FBTyxDQUFDQyxjQUFjLENBQUM7SUFDbENXLElBQUksQ0FBQ3hCLE1BQU0sQ0FBQ1ksT0FBTyxDQUFDQyxjQUFjLENBQUM7SUFDbkNFLEdBQUcsQ0FBQ2YsTUFBTSxDQUFDeUIsR0FBRyxDQUFDQyxLQUFLLENBQUNGLElBQUksQ0FBQztFQUM1QixDQUFDLENBQUM7RUFFRmxCLEVBQUUsQ0FBQywrREFBK0QsRUFBRSxrQkFBa0I7SUFDcEYsSUFBSVMsR0FBRyxHQUFHLE1BQU1QLGNBQU8sQ0FBQ21CLFNBQVMsQ0FBQyxDQUFDO0lBQ25DWixHQUFHLENBQUNmLE1BQU0sQ0FBQ3FCLEVBQUUsQ0FBQ0UsQ0FBQyxDQUFDLFFBQVEsQ0FBQztJQUN6QixNQUFNTCxTQUFFLENBQUNDLE1BQU0sQ0FBQ0osR0FBRyxDQUFDLENBQUNmLE1BQU0sQ0FBQ29CLFVBQVUsQ0FBQ0MsRUFBRSxDQUFDQyxFQUFFO0lBQzVDLElBQUlFLElBQUksR0FBRyxNQUFNaEIsY0FBTyxDQUFDbUIsU0FBUyxDQUFDLENBQUM7SUFDcEMsTUFBTVQsU0FBRSxDQUFDQyxNQUFNLENBQUNLLElBQUksQ0FBQyxDQUFDeEIsTUFBTSxDQUFDb0IsVUFBVSxDQUFDQyxFQUFFLENBQUNDLEVBQUU7SUFDN0NQLEdBQUcsQ0FBQ2YsTUFBTSxDQUFDMEIsS0FBSyxDQUFDRixJQUFJLENBQUM7RUFDeEIsQ0FBQyxDQUFDO0FBQ0osQ0FBQyxDQUFDIn0=
